/*Query1 - the query used for the second insight*/WITH cat_quartile AS     (SELECT f.title, c.name AS category, f.rental_duration,             NTILE(4) OVER(ORDER BY f.rental_duration) AS quartile     FROM category c     JOIN film_category fc     ON c.category_id = fc.category_id     JOIN film f     ON f.film_id = fc.film_id     WHERE c.name IN ('Animation', 'Children', 'Classics',                        'Comedy', 'Family', 'Music'))SELECT category, quartile, COUNT(*)FROM cat_quartileGROUP BY 1, 2ORDER BY 1, 2;/*Query2 - the query used for the second insight*/SELECT f.title, c.name AS category, COUNT(r.rental_id) AS rental_countFROM category cJOIN film_category fcON c.category_id = fc.category_idJOIN film fON f.film_id = fc.film_idJOIN inventory iON f.film_id = i.film_idJOIN rental rON i.inventory_id = r.inventory_idWHERE c.name IN ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music')GROUP BY 1, 2ORDER BY 2, 1;/*Query3 - the query used for the third insight*/  WITH t1 AS (SELECT title maxtitle, film_id              FROM film              WHERE length=               (SELECT MAX(length)                FROM film))  SELECT  t1.maxtitle,   f.length,   p.payment_date AS payment_date,   CONCAT(first_name, ' ', last_name) AS customer_name,   p.amount AS amount,   AVG(p.amount) OVER (ORDER BY   p.payment_date) AS average_amount_of_payment FROM   payment p    JOIN      customer c       ON p.customer_id = c.customer_id    JOIN      rental r       ON p.rental_id = r.rental_id    JOIN      inventory i       ON i.inventory_id = r.inventory_id    JOIN      film f       ON f.film_id = i.inventory_id      JOIN t1      ON t1.film_id=f.film_id   WHERE f.title= t1.maxtitle GROUP BY   p.payment_date,   c.first_name,   c.last_name,   p.amount,   t1.maxtitle,   f.lengthHAVING   MIN(amount) > 0.00ORDER BY maxtitle/*Query4 - the query used for the fourth insight*/WITH t1 AS     (SELECT         f.title AS film_name,         COUNT(a.actor_id) AS number_of_actors       FROM         film_actor fa          JOIN            film f             ON f.film_id = fa.film_id          JOIN            actor a             ON a.actor_id = fa.actor_id       GROUP BY         f.title)SELECT   film_name AS film_name,   number_of_actors AS number_of_actors FROM t1   GROUP BY   1,2ORDER BY 2 DESC LIMIT 10;